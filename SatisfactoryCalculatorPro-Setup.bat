@echo off
title Satisfactory Calculator Pro - Installer

REM ???????????????? ???????? ????????????????????????????
net session >nul 2>&1
if %errorLevel% neq 0 (
    echo ?????? ?????????????????? ?????????????????? ?????????? ????????????????????????????!
    echo ?????????????????????????? ???? ?????????? ????????????????????????????.
    pause
    exit /b 1
)

echo ================================================
echo  Satisfactory Calculator Pro v1.0 - Installer
echo ================================================
echo.
echo ???????? ???????????????????? ?????????????????? Satisfactory Calculator Pro
echo ???? ?????? ??????????????????.
echo.
echo ?????????????? ?????????? ?????????????? ?????? ??????????????????????...
pause >nul

REM ?????????????? ?????????????????? ??????????
set "TEMP_DIR=%TEMP%\SatisCalc_%RANDOM%"
mkdir "%TEMP_DIR%"

REM ?????????????????? ?????????????????????? ????????????
echo ???????????????????? ????????????...
powershell -Command "Expand-Archive -Path '%~dp0SatisfactoryCalculatorPro-v1.0-Portable.zip' -DestinationPath '%TEMP_DIR%' -Force"

REM ?????????????????? ??????????????????
call "%~dp0install.bat"

REM ??????????????
rmdir /s /q "%TEMP_DIR%" 2>nul
